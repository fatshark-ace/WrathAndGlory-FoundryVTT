"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.WrathAndGloryItem = void 0;
class WrathAndGloryItem extends Item {
    async sendToChat() {
        const item = new CONFIG.Item.documentClass(this.data._source);
        if (item.data.img.includes("/unknown")) {
            item.data.img = null;
        }
        const html = await renderTemplate("systems/wrath-and-glory/template/chat/item.html", { item, data: item.data.data });
        const chatData = {
            user: game.user,
            rollMode: game.settings.get("core", "rollMode"),
            content: html,
        };
        if (["gmroll", "blindroll"].includes(chatData.rollMode)) {
            chatData.whisper = ChatMessage.getWhisperRecipients("GM");
        }
        else if (chatData.rollMode === "selfroll") {
            chatData.whisper = [game.user];
        }
        ChatMessage.create(chatData);
    }
    _dataWithRank(type) {
        let data = this[type];
        let damage = data.base + data.bonus;
        let rank = "";
        if (data.rank === "single") {
            rank = " + R";
        }
        else if (data.rank === "double") {
            rank = " + DR";
        }
        return `${damage}${rank}`;
    }
    // @@@@@@ FORMATTED GETTERs @@@@@@
    get Range() {
        const short = this.range.short < 1 ? "-" : this.range.short;
        const medium = this.range.medium < 1 ? "-" : this.range.medium;
        const long = this.range.long < 1 ? "-" : this.range.long;
        const salvo = this.salvo < 1 ? "-" : this.salvo;
        return `${salvo} | ${short} / ${medium} / ${long}`;
    }
    get Damage() {
        return this._dataWithRank("damage");
    }
    get ED() {
        return this._dataWithRank("ed");
    }
    get AP() {
        return this._dataWithRank("ap");
    }
    get Activation() {
        switch (this.activation) {
            case "free":
                return game.i18n.localize("ACTIVATION.FREE");
            case "action":
                return game.i18n.localize("ACTIVATION.ACTION");
            case "simple":
                return game.i18n.localize("ACTIVATION.SIMPLE");
            case "full":
                return game.i18n.localize("ACTIVATION.FULL");
            case "movement":
                return game.i18n.localize("ACTIVATION.MOVEMENT");
            default:
                return game.i18n.localize("ACTIVATION.ACTION");
        }
    }
    get Rarity() {
        switch (this.rarity) {
            case "common":
                return game.i18n.localize("RARITY.COMMON");
            case "uncommon":
                return game.i18n.localize("RARITY.UNCOMMON");
            case "rare":
                return game.i18n.localize("RARITY.RARE");
            case "very-rare":
                return game.i18n.localize("RARITY.VERY_RARE");
            case "unique":
                return game.i18n.localize("RARITY.UNIQUE");
            default:
                return game.i18n.localize("RARITY.COMMON");
        }
    }
    get Category() {
        switch (this.category) {
            case "melee":
                return game.i18n.localize("CATEGORY.MELEE");
            case "ranged":
                return game.i18n.localize("CATEGORY.RANGED");
            default:
                return game.i18n.localize("CATEGORY.MELEE");
        }
    }
    get MultiTarget() {
        return this.multiTarget ? game.i18n.localize("Yes") : game.i18n.localize("No");
    }
    // @@@@@@ TYPE GETTERS @@@@@@
    get isKeyword() { return this.type === "keyword"; }
    get isTalent() { return this.type === "talent"; }
    get isAbility() { return this.type === "ability"; }
    get isTalentOrAbility() { return this.isTalent || this.isAbility; }
    get isPsychicPower() { return this.type === "psychicPower"; }
    get isArmour() { return this.type === "armour"; }
    get isWeapon() { return this.type === "weapon"; }
    get isWeaponUpgrade() { return this.type === "weaponUpgrade"; }
    get isGear() { return this.type === "gear"; }
    get isTraumaticInjury() { return this.type === "traumaticInjury"; }
    get isMemorableInjury() { return this.type === "memorableInjury"; }
    get isAscension() { return this.type === "ascension"; }
    get isMutation() { return this.type === "mutation"; }
    get isAmmo() { return this.type === "ammo"; }
    get isAugmentic() { return this.type === "augmentic"; }
    // @@@@@@ DATA GETTERS @@@@@@
    get bonus() { return this.data.data.bonus; }
    get effect() { return this.data.data.effect; }
    get cost() { return this.data.data.cost; }
    get requirements() { return this.data.data.requirements; }
    get description() { return this.data.data.description; }
    get display() { return this.data.data.display; }
    get value() { return this.data.data.value; }
    get rarity() { return this.data.data.rarity; }
    get keywords() { return this.data.data.keywords; }
    get quantity() { return this.data.data.quantity; }
    get rating() { return this.data.data.rating; }
    get traits() { return this.data.data.traits; }
    get influence() { return this.data.data.influence; }
    get benefits() { return this.data.data.benefits; }
    get dn() { return this.data.data.dn; }
    get activation() { return this.data.data.activation; }
    get duration() { return this.data.data.duration; }
    get range() { return this.data.data.range; }
    get multiTarget() { return this.data.data.multiTarget; }
    get prerequisites() { return this.data.data.prerequisites; }
    get potency() { return this.data.data.potency; }
    get damage() { return this.data.data.damage; }
    get ed() { return this.data.data.ed; }
    get attack() { return this.data.data.attack; }
    get ap() { return this.data.data.ap; }
    get category() { return this.data.data.category; }
    get salvo() { return this.data.data.salvo; }
    get upgrades() { return this.data.data.upgrades; }
}
exports.WrathAndGloryItem = WrathAndGloryItem;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tb24vaXRlbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSxNQUFhLGlCQUFrQixTQUFRLElBQUk7SUFDdkMsS0FBSyxDQUFDLFVBQVU7UUFDWixNQUFNLElBQUksR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDN0QsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDcEMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO1NBQ3hCO1FBRUQsTUFBTSxJQUFJLEdBQUcsTUFBTSxjQUFjLENBQUMsaURBQWlELEVBQUUsRUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNuSCxNQUFNLFFBQVEsR0FBYTtZQUN2QixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7WUFDZixRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQztZQUMvQyxPQUFPLEVBQUUsSUFBSTtTQUNoQixDQUFDO1FBQ0YsSUFBSSxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ3JELFFBQVEsQ0FBQyxPQUFPLEdBQUcsV0FBVyxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzdEO2FBQU0sSUFBSSxRQUFRLENBQUMsUUFBUSxLQUFLLFVBQVUsRUFBRTtZQUN6QyxRQUFRLENBQUMsT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2xDO1FBQ0QsV0FBVyxDQUFDLE1BQU0sQ0FBQyxR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dEQsNkJBQTZCO0lBQzdCLElBQUksS0FBSyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFBLENBQUMsQ0FBQztJQUMzQyxJQUFJLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQSxDQUFDLENBQUM7SUFDN0MsSUFBSSxJQUFJLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUEsQ0FBQyxDQUFDO0lBQ3pDLElBQUksWUFBWSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFBLENBQUMsQ0FBQztJQUN6RCxJQUFJLFdBQVcsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQSxDQUFDLENBQUM7SUFDdkQsSUFBSSxPQUFPLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUEsQ0FBQyxDQUFDO0lBQy9DLElBQUksS0FBSyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFBLENBQUMsQ0FBQztJQUMzQyxJQUFJLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQSxDQUFDLENBQUM7SUFDN0MsSUFBSSxRQUFRLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUEsQ0FBQyxDQUFDO0lBQ2pELElBQUksUUFBUSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBLENBQUMsQ0FBQztJQUNqRCxJQUFJLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQSxDQUFDLENBQUM7SUFDN0MsSUFBSSxNQUFNLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUEsQ0FBQyxDQUFDO0lBQzdDLElBQUksU0FBUyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFBLENBQUMsQ0FBQztJQUNuRCxJQUFJLFFBQVEsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQSxDQUFDLENBQUM7SUFDakQsSUFBSSxFQUFFLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUEsQ0FBQyxDQUFDO0lBQ3JDLElBQUksVUFBVSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFBLENBQUMsQ0FBQztJQUNyRCxJQUFJLFFBQVEsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQSxDQUFDLENBQUM7SUFDakQsSUFBSSxLQUFLLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQyxDQUFDO0lBQzNDLElBQUksV0FBVyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFBLENBQUMsQ0FBQztJQUN2RCxJQUFJLGFBQWEsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQSxDQUFDLENBQUM7SUFDM0QsSUFBSSxPQUFPLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUEsQ0FBQyxDQUFDO0lBQy9DLElBQUksTUFBTSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFBLENBQUMsQ0FBQztJQUM3QyxJQUFJLEVBQUUsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFDLENBQUM7SUFDckMsSUFBSSxNQUFNLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUEsQ0FBQyxDQUFDO0lBQzdDLElBQUksRUFBRSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUMsQ0FBQztJQUNyQyxJQUFJLFFBQVEsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQSxDQUFDLENBQUM7SUFDakQsSUFBSSxLQUFLLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQyxDQUFDO0lBQzNDLElBQUksUUFBUSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBLENBQUMsQ0FBQztDQUVwRDtBQW5KRCw4Q0FtSkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NoYXREYXRhfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuZXhwb3J0IGNsYXNzIFdyYXRoQW5kR2xvcnlJdGVtIGV4dGVuZHMgSXRlbSB7XG4gICAgYXN5bmMgc2VuZFRvQ2hhdCgpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IG5ldyBDT05GSUcuSXRlbS5kb2N1bWVudENsYXNzKHRoaXMuZGF0YS5fc291cmNlKVxuICAgICAgICBpZiAoaXRlbS5kYXRhLmltZy5pbmNsdWRlcyhcIi91bmtub3duXCIpKSB7XG4gICAgICAgICAgICBpdGVtLmRhdGEuaW1nID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZW5kZXJUZW1wbGF0ZShcInN5c3RlbXMvd3JhdGgtYW5kLWdsb3J5L3RlbXBsYXRlL2NoYXQvaXRlbS5odG1sXCIsIHtpdGVtLCBkYXRhOiBpdGVtLmRhdGEuZGF0YX0pO1xuICAgICAgICBjb25zdCBjaGF0RGF0YTogQ2hhdERhdGEgPSB7XG4gICAgICAgICAgICB1c2VyOiBnYW1lLnVzZXIsXG4gICAgICAgICAgICByb2xsTW9kZTogZ2FtZS5zZXR0aW5ncy5nZXQoXCJjb3JlXCIsIFwicm9sbE1vZGVcIiksXG4gICAgICAgICAgICBjb250ZW50OiBodG1sLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoW1wiZ21yb2xsXCIsIFwiYmxpbmRyb2xsXCJdLmluY2x1ZGVzKGNoYXREYXRhLnJvbGxNb2RlKSkge1xuICAgICAgICAgICAgY2hhdERhdGEud2hpc3BlciA9IENoYXRNZXNzYWdlLmdldFdoaXNwZXJSZWNpcGllbnRzKFwiR01cIik7XG4gICAgICAgIH0gZWxzZSBpZiAoY2hhdERhdGEucm9sbE1vZGUgPT09IFwic2VsZnJvbGxcIikge1xuICAgICAgICAgICAgY2hhdERhdGEud2hpc3BlciA9IFtnYW1lLnVzZXJdO1xuICAgICAgICB9XG4gICAgICAgIENoYXRNZXNzYWdlLmNyZWF0ZShjaGF0RGF0YSk7XG4gICAgfVxuXG4gICAgX2RhdGFXaXRoUmFuayh0eXBlOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGRhdGEgPSAodGhpcyBhcyBhbnkpW3R5cGVdXG4gICAgICAgIGxldCBkYW1hZ2UgPSBkYXRhLmJhc2UgKyBkYXRhLmJvbnVzO1xuICAgICAgICBsZXQgcmFuayA9IFwiXCI7XG4gICAgICAgIGlmIChkYXRhLnJhbmsgPT09IFwic2luZ2xlXCIpIHtcbiAgICAgICAgICAgIHJhbmsgPSBcIiArIFJcIjtcbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnJhbmsgPT09IFwiZG91YmxlXCIpIHtcbiAgICAgICAgICAgIHJhbmsgPSBcIiArIERSXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke2RhbWFnZX0ke3Jhbmt9YDtcbiAgICB9XG5cbiAgICAvLyBAQEBAQEAgRk9STUFUVEVEIEdFVFRFUnMgQEBAQEBAXG4gICAgZ2V0IFJhbmdlKCkge1xuICAgICAgICBjb25zdCBzaG9ydCA9IHRoaXMucmFuZ2Uuc2hvcnQgPCAxID8gXCItXCIgOiB0aGlzLnJhbmdlLnNob3J0O1xuICAgICAgICBjb25zdCBtZWRpdW0gPSB0aGlzLnJhbmdlLm1lZGl1bSA8IDEgPyBcIi1cIiA6IHRoaXMucmFuZ2UubWVkaXVtO1xuICAgICAgICBjb25zdCBsb25nID0gdGhpcy5yYW5nZS5sb25nIDwgMSA/IFwiLVwiIDogdGhpcy5yYW5nZS5sb25nO1xuICAgICAgICBjb25zdCBzYWx2byA9IHRoaXMuc2Fsdm8gPCAxID8gXCItXCIgOiB0aGlzLnNhbHZvO1xuICAgICAgICByZXR1cm4gYCR7c2Fsdm99IHwgJHtzaG9ydH0gLyAke21lZGl1bX0gLyAke2xvbmd9YDtcbiAgICB9XG5cbiAgICBnZXQgRGFtYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YVdpdGhSYW5rKFwiZGFtYWdlXCIpO1xuICAgIH1cbiAgICBnZXQgRUQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhV2l0aFJhbmsoXCJlZFwiKTtcbiAgICB9XG4gICAgZ2V0IEFQKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YVdpdGhSYW5rKFwiYXBcIik7XG4gICAgfVxuXG4gICAgZ2V0IEFjdGl2YXRpb24oKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5hY3RpdmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiZnJlZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJBQ1RJVkFUSU9OLkZSRUVcIik7XG4gICAgICAgICAgICBjYXNlIFwiYWN0aW9uXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZShcIkFDVElWQVRJT04uQUNUSU9OXCIpO1xuICAgICAgICAgICAgY2FzZSBcInNpbXBsZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJBQ1RJVkFUSU9OLlNJTVBMRVwiKTtcbiAgICAgICAgICAgIGNhc2UgXCJmdWxsXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZShcIkFDVElWQVRJT04uRlVMTFwiKTtcbiAgICAgICAgICAgIGNhc2UgXCJtb3ZlbWVudFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJBQ1RJVkFUSU9OLk1PVkVNRU5UXCIpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2FtZS5pMThuLmxvY2FsaXplKFwiQUNUSVZBVElPTi5BQ1RJT05cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IFJhcml0eSgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnJhcml0eSkge1xuICAgICAgICAgICAgY2FzZSBcImNvbW1vblwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJSQVJJVFkuQ09NTU9OXCIpO1xuICAgICAgICAgICAgY2FzZSBcInVuY29tbW9uXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZShcIlJBUklUWS5VTkNPTU1PTlwiKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXJlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZShcIlJBUklUWS5SQVJFXCIpO1xuICAgICAgICAgICAgY2FzZSBcInZlcnktcmFyZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJSQVJJVFkuVkVSWV9SQVJFXCIpO1xuICAgICAgICAgICAgY2FzZSBcInVuaXF1ZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJSQVJJVFkuVU5JUVVFXCIpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2FtZS5pMThuLmxvY2FsaXplKFwiUkFSSVRZLkNPTU1PTlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgQ2F0ZWdvcnkoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5jYXRlZ29yeSkge1xuICAgICAgICAgICAgY2FzZSBcIm1lbGVlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZShcIkNBVEVHT1JZLk1FTEVFXCIpO1xuICAgICAgICAgICAgY2FzZSBcInJhbmdlZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJDQVRFR09SWS5SQU5HRURcIik7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoXCJDQVRFR09SWS5NRUxFRVwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBNdWx0aVRhcmdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlUYXJnZXQgPyBnYW1lLmkxOG4ubG9jYWxpemUoXCJZZXNcIikgOiBnYW1lLmkxOG4ubG9jYWxpemUoXCJOb1wiKVxuICAgIH1cblxuXG4gICAgLy8gQEBAQEBAIFRZUEUgR0VUVEVSUyBAQEBAQEBcbiAgICBnZXQgaXNLZXl3b3JkKCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcImtleXdvcmRcIiB9XG4gICAgZ2V0IGlzVGFsZW50KCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcInRhbGVudFwiIH1cbiAgICBnZXQgaXNBYmlsaXR5KCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcImFiaWxpdHlcIiB9XG4gICAgZ2V0IGlzVGFsZW50T3JBYmlsaXR5KCkgeyByZXR1cm4gdGhpcy5pc1RhbGVudCB8fCB0aGlzLmlzQWJpbGl0eSB9XG4gICAgZ2V0IGlzUHN5Y2hpY1Bvd2VyKCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcInBzeWNoaWNQb3dlclwiIH1cbiAgICBnZXQgaXNBcm1vdXIoKSB7IHJldHVybiB0aGlzLnR5cGUgPT09IFwiYXJtb3VyXCIgfVxuICAgIGdldCBpc1dlYXBvbigpIHsgcmV0dXJuIHRoaXMudHlwZSA9PT0gXCJ3ZWFwb25cIiB9XG4gICAgZ2V0IGlzV2VhcG9uVXBncmFkZSgpIHsgcmV0dXJuIHRoaXMudHlwZSA9PT0gXCJ3ZWFwb25VcGdyYWRlXCIgfVxuICAgIGdldCBpc0dlYXIoKSB7IHJldHVybiB0aGlzLnR5cGUgPT09IFwiZ2VhclwiIH1cbiAgICBnZXQgaXNUcmF1bWF0aWNJbmp1cnkoKSB7IHJldHVybiB0aGlzLnR5cGUgPT09IFwidHJhdW1hdGljSW5qdXJ5XCIgfVxuICAgIGdldCBpc01lbW9yYWJsZUluanVyeSgpIHsgcmV0dXJuIHRoaXMudHlwZSA9PT0gXCJtZW1vcmFibGVJbmp1cnlcIiB9XG4gICAgZ2V0IGlzQXNjZW5zaW9uKCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcImFzY2Vuc2lvblwiIH1cbiAgICBnZXQgaXNNdXRhdGlvbigpIHsgcmV0dXJuIHRoaXMudHlwZSA9PT0gXCJtdXRhdGlvblwiIH1cbiAgICBnZXQgaXNBbW1vKCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcImFtbW9cIiB9XG4gICAgZ2V0IGlzQXVnbWVudGljKCkgeyByZXR1cm4gdGhpcy50eXBlID09PSBcImF1Z21lbnRpY1wiIH1cblxuICAgIC8vIEBAQEBAQCBEQVRBIEdFVFRFUlMgQEBAQEBAXG4gICAgZ2V0IGJvbnVzKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuYm9udXMgfVxuICAgIGdldCBlZmZlY3QoKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5lZmZlY3QgfVxuICAgIGdldCBjb3N0KCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuY29zdCB9XG4gICAgZ2V0IHJlcXVpcmVtZW50cygpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLnJlcXVpcmVtZW50cyB9XG4gICAgZ2V0IGRlc2NyaXB0aW9uKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuZGVzY3JpcHRpb24gfVxuICAgIGdldCBkaXNwbGF5KCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuZGlzcGxheSB9XG4gICAgZ2V0IHZhbHVlKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEudmFsdWUgfVxuICAgIGdldCByYXJpdHkoKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5yYXJpdHkgfVxuICAgIGdldCBrZXl3b3JkcygpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmtleXdvcmRzIH1cbiAgICBnZXQgcXVhbnRpdHkoKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5xdWFudGl0eSB9XG4gICAgZ2V0IHJhdGluZygpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLnJhdGluZyB9XG4gICAgZ2V0IHRyYWl0cygpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLnRyYWl0cyB9XG4gICAgZ2V0IGluZmx1ZW5jZSgpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmluZmx1ZW5jZSB9XG4gICAgZ2V0IGJlbmVmaXRzKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuYmVuZWZpdHMgfVxuICAgIGdldCBkbigpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmRuIH1cbiAgICBnZXQgYWN0aXZhdGlvbigpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmFjdGl2YXRpb24gfVxuICAgIGdldCBkdXJhdGlvbigpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmR1cmF0aW9uIH1cbiAgICBnZXQgcmFuZ2UoKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5yYW5nZSB9XG4gICAgZ2V0IG11bHRpVGFyZ2V0KCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEubXVsdGlUYXJnZXQgfVxuICAgIGdldCBwcmVyZXF1aXNpdGVzKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEucHJlcmVxdWlzaXRlcyB9XG4gICAgZ2V0IHBvdGVuY3koKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5wb3RlbmN5IH1cbiAgICBnZXQgZGFtYWdlKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuZGFtYWdlIH1cbiAgICBnZXQgZWQoKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5lZCB9XG4gICAgZ2V0IGF0dGFjaygpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmF0dGFjayB9XG4gICAgZ2V0IGFwKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEuYXAgfVxuICAgIGdldCBjYXRlZ29yeSgpIHsgcmV0dXJuIHRoaXMuZGF0YS5kYXRhLmNhdGVnb3J5IH1cbiAgICBnZXQgc2Fsdm8oKSB7IHJldHVybiB0aGlzLmRhdGEuZGF0YS5zYWx2byB9XG4gICAgZ2V0IHVwZ3JhZGVzKCkgeyByZXR1cm4gdGhpcy5kYXRhLmRhdGEudXBncmFkZXMgfVxuXG59Il19